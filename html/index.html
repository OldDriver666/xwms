
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>智能设备管理平台</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">
<script>
function getCookie(name){
    var start = document.cookie.indexOf(name + "=");
    var len = start + name.length + 1;
    if ((!start) && (name != document.cookie.substring(0, name.length))) {
        return "";
    }
    if (start == - 1) {
        return "";
    }
    var end = document.cookie.indexOf(';', len);
    if (end == - 1) {
        end = document.cookie.length;
    }
    return unescape(document.cookie.substring(len, end));
}
var token_value = getCookie("accesstoken");
if(token_value == ""){
    window.location.href = "login.html";
}
</script>
<link rel="stylesheet" href="layui/css/layui.css" media="all">
<link rel="stylesheet" href="css/global.css" media="all">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link id="layuicss-skinlayercss" rel="stylesheet" href="layui/css/modules/layer/default/layer.css" media="all">
	<style>
		.layui-tab-title{
			background-color: #e3eae9;
		}
		.layui-tab-title .layui-this{
			background-color: #fff;
		}
	</style>
</head>
<body>
<div class="layui-layout layui-layout-admin">
	<div class="layui-header header header-demo">
		<div class="layui-main">
			<a class="logo" style="left: 0;" href="index.html">
				<span style="font-size: 22px;">智能设备管理平台</span>
			</a>
			<ul class="layui-nav head-r-nav">
				<li class="layui-nav-item">
					<a href="javascript:;" class="admin-header-user">
						<img src="images/0.jpg" style="width: 40px; height: 40px; border-radius: 100%;">
						<span id="admin-header-nick"></span>
						<span class="layui-nav-more"></span>
					</a>
					<dl class="layui-nav-child" style="display: none;">
						<dd>
							<a href="javascript:;" data-url="manage/myInfo/myInfo.html"><i class="fa fa-user-circle" aria-hidden="true"></i> 个人信息</a>
						</dd>
						<dd>
							<a href="javascript:;" id="header-safeExit"><i class="fa fa-sign-out" aria-hidden="true"></i> 安全退出</a>
						</dd>
					</dl>
				</li>
			</ul>
		</div>
	</div>
	<div class="layui-side layui-bg-black">
		<div class="layui-side-scroll">
			<ul class="layui-nav layui-nav-tree admin-nav-tree" id="menuContent"></ul>
		</div>
	</div>
	<div class="layui-body">
		<div class="layui-tab admin-nav-card" lay-filter="admin-tab">
			<ul class="layui-tab-title" id="admin-tab">
				<li class="layui-this">
					<i class="layui-icon" style="top: 2px; font-size: 16px;">&#xe63c;</i>
					<cite>统计概况</cite>
				</li>
			</ul>
			<div class="layui-tab-content"  id="admin-tab-container">
				<div class="layui-tab-item layui-show">
					<iframe src="manage/main/main.html"></iframe>
				</div>
			</div>
		</div>
	</div>

	<div class="site-tree-mobile layui-hide"><i class="layui-icon"></i></div>
	<div class="site-mobile-shade"></div>

</div>
<script src="js/jquery.min.js"></script>
<script src="js/jquery.i18n.properties-min-1.0.9.js"></script>
<script type ="text/javascript" src="js/jquery.tmpl.js"></script>
<script src="js/Util.js"></script>
<script src="resource/lib/jquery.md5.js"></script>
<script src="js/index.js"></script>

<script type="text/x-jquery-tmpl" id="pageMenu">
<li class="layui-nav-item layui-nav-itemed">
	<dl class="layui-nav-child">
		<dd>
			<a href="javascript:;" data-menuid=${AuthDirId} data-url=${AuthInterface}?id=${AuthDirId}>
				<i class="layui-icon" style="top:2px; font-size:16px;">&#xe63c;</i>
				<cite>${AuthDirName}</cite>
			</a>
		</dd>
	</dl>
</li>
</script>

<script type="text/javascript" src="layui/layui.js"></script>
<script>
	layui.use(['element', 'layer'], function() {
		var element = layui.element(),
			$ = layui.jquery,
			layer = layui.layer;

		//iframe自适应
		$(window).on('resize', function() {
			var $content = $('.admin-nav-card .layui-tab-content');
			$content.height($(this).height() - 131);
			$content.find('iframe').each(function() {
				$(this).height($content.height());
			});
		}).resize();

		//添加tab
		var $tabs = $('#admin-tab');
		var $container = $('#admin-tab-container');
		//绑定 nav 点击事件
		$('ul.admin-nav-tree, ul.head-r-nav').find('dd > a').each(function() {
			var $this = $(this);
			//获取设定的url
			var url = $this.data('url');
			if(url !== undefined) {
				$this.on('click', function() {
					var iframe = '<iframe src="' + url + '"></iframe>';
					var aHtml = $this.html();
					var count = 0;
					var tabIndex;
					$tabs.find('li').each(function(i, e) {
						var $cite = $(this).children('cite');
						if($cite.text() === $this.find('cite').text()) {
							count++;
							tabIndex = i;
						};
					});
					//tab不存在
					if(count === 0) {
						//添加删除样式
						aHtml += '<i class="layui-icon layui-unselect layui-tab-close">&#x1006;</i>';
						//添加tab
						element.tabAdd('admin-tab', {
							title: aHtml,
							content: iframe
						});
						//iframe 自适应
						var $content = $('.admin-nav-card .layui-tab-content');
						$content.find('iframe').each(function() {
							$(this).height($content.height());
						});
						//绑定关闭事件
						$tabs = $('#admin-tab');
						var $li = $tabs.find('li');
						$li.eq($li.length - 1).children('i.layui-tab-close').on('click', function() {
							element.tabDelete('admin-tab', $(this).parent('li').index()).init();
						});
						//获取焦点
						element.tabChange('admin-tab', $li.length - 1);

					} else {
						//切换tab
						element.tabChange('admin-tab', tabIndex);
					}
				});
			}
		});

		$('#user').on('click', function() {
			$('#user-item').toggle();
		});

		//手机设备的简单适配
		var treeMobile = $('.site-tree-mobile'),
			shadeMobile = $('.site-mobile-shade');
		treeMobile.on('click', function() {
			$('body').addClass('site-mobile');
		});
		shadeMobile.on('click', function() {
			$('body').removeClass('site-mobile');
		});
	});
</script>
	
<script type="text/javascript">
layui.config({
    base: 'js/'
});
</script>

</body>
</html>